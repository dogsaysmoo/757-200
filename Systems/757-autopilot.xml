<?xml version="1.0"?>


<PropertyList>

  <!-- =============================================================== -->
  <!--                        Lateral Modes                            -->
  <!-- =============================================================== -->

  <filter>
    <name>Radar altimeter</name>
    <type>gain</type>
    <gain>1.0</gain>
    <input>/position/gear-agl-ft</input>
    <output>instrumentation/afds/ra-ft</output>
  </filter>

  <pid-controller>
    <name>TO/GA1</name>
    <debug>false</debug>
    <enable>
      <prop>instrumentation/afds/ap-modes/roll-mode</prop>
      <value>TO/GA</value>
    </enable>
    <input>
      <prop>orientation/roll-deg</prop>
    </input>
    <reference>
      <value>0.0</value>
    </reference>
    <output>
      <prop>/autopilot/internal/target-roll-deg</prop>
    </output>
    <config>
      <Ts>0.05</Ts> 
      <Kp>-1.0</Kp>
      <beta>1.0</beta>
      <alpha>0.1</alpha>
      <gamma>0.0</gamma>
      <Ti>10.0</Ti>
      <Td>0.0</Td>
        <u_min>
            <prop>instrumentation/afds/settings/bank-min</prop>
        </u_min>
        <u_max>
            <prop>instrumentation/afds/settings/bank-max</prop>
        </u_max>
    </config>
  </pid-controller>

	<!--filter>
                <name>Heading bug error computer/normalizer</name>
                <type>gain</type>
                <debug type="bool">false</debug>
                <gain>1</gain>
                <input-->
                        <!--property>autopilot/settings/heading-bug-deg</property>
                        <offset>
                                <property>instrumentation/heading-indicator[0]/indicated-heading-deg</property>
                                <scale>-1</scale>
                        </offset-->
			<!--property>autopilot/internal/fdm-heading-bug-error-deg</property>
			<scale>1</scale>
                </input>
                <output>autopilot/internal/heading-bug-error-deg</output>
                <period>
                        <min>-180</min>
                        <max>180</max>
                </period>
        </filter-->

  <filter>
    <name>true heading error computer/normalizer</name>
    <debug>false</debug>
    <type>gain</type>
    <enable>
	<condition>
		<property>instrumentation/efis/mfd/true-north</property>
	</condition>
    </enable>
    <input>
      <property>autopilot/settings/heading-bug-deg</property>
      <offset>
        <property>orientation/heading-deg</property>
        <scale>-1.0</scale>
      </offset>
    </input>
    <output>autopilot/internal/hdg-hold-error-deg</output>
    <period>
      <min>-180</min>
      <max>180</max>
    </period>
    <gain>1.0</gain>
  </filter>

  <filter>
    <name>Mag Hdg</name>
    <type>gain</type>
    <debug>false</debug>
    <gain>1</gain>
    <enable>
	<condition>
	    <not>
		<property>instrumentation/efis/mfd/true-north</property>
	    </not>
	</condition>
    </enable>
    <input>autopilot/internal/fdm-heading-bug-error-deg</input>
    <output>autopilot/internal/hdg-hold-error-deg</output>
  </filter>

  <pi-simple-controller>
    <name>HDG HOLD</name>
    <debug>false</debug>
    <enable>
      <condition>
        <or>
          <equals>
            <property>instrumentation/afds/ap-modes/roll-mode</property>
            <value>HDG SEL</value>
          </equals>
          <equals>
            <property>instrumentation/afds/ap-modes/roll-mode</property>
            <value>HDG HOLD</value>
          </equals>
        </or>
      </condition>
    </enable>
    <input>
      <!--prop>autopilot/internal/fdm-heading-bug-error-deg</prop-->
      <prop>autopilot/internal/hdg-hold-error-deg</prop>
    </input>
    <reference>
      <value>0</value>
    </reference>
    <output>
      <prop>/autopilot/internal/target-roll-deg</prop>
    </output>
    <config>
      <Kp>-2</Kp>
      <Ki>0.0</Ki>
        <u_min>
            <prop>instrumentation/afds/settings/bank-min</prop>
        </u_min>
        <u_max>
            <prop>instrumentation/afds/settings/bank-max</prop>
        </u_max>
    </config>
   </pi-simple-controller>

 <!--filter>
    <name>LNAV waypoint error computer/normalizer</name>
    <debug>false</debug>
    <enable>
      <prop>instrumentation/afds/ap-modes/roll-mode</prop>
      <value>LNAV</value>
    </enable>
    <type>gain</type>
    <input>
      <prop>/autopilot/route-manager/wp/bearing-deg</prop>
      <offset>
        <property>/orientation/heading-magnetic-deg</property>
        <scale>-1.0</scale>
      </offset>
    </input>
    <output>autopilot/internal/waypoint-bearing-error-deg</output>
    <period>
      <min>-180</min>
      <max>180</max>
    </period>
    <gain>1.0</gain>
  </filter-->

	<!--filter>
                <name>LNAV course error filter</name>
                <debug>false</debug>
                <type>noise-spike</type>
                <enable>
                        <property>instrumentation/afds/ap-modes/roll-mode</property>
                        <value>LNAV</value>
                </enable>
                <max-rate-of-change>0.2</max-rate-of-change>
                <initialize-to>output</initialize-to>
                <input>
                        <property>autopilot/internal/course-error</property>
                </input>
                <output>autopilot/internal/course-error-filtered</output>
        </filter>

        <filter>
                <name>LNAV waypoint error computer/normalizer</name>
                <debug>false</debug>
                <enable>
                        <property>instrumentation/afds/ap-modes/roll-mode</property>
                        <value>LNAV</value>
                </enable>
                <type>gain</type>
                <input>
                        <property>autopilot/internal/course-deg</property>
                        <offset>
                                <property>/orientation/heading-deg</property>
                                <scale>-1.0</scale>
                        </offset>
                </input>
                <output>autopilot/internal/waypoint-bearing-error-deg</output>
                <period>
                        <min>-180</min>
                        <max>180</max>
                </period>
                <gain>1.0</gain>
        </filter>

        <filter>
                <name>LNAV course error to waypoint error computer/normalizer </name>
                <debug>false</debug>
                <enable>
                        <property>instrumentation/afds/ap-modes/roll-mode</property>
                        <value>LNAV</value>
                </enable>
                <type>gain</type>
                <input>
                        <property>autopilot/internal/waypoint-bearing-error-deg</property>
                        <offset>
                                <property>autopilot/internal/course-error-filtered</property>
                                <scale>1.0</scale>
                        </offset>
                </input>
                <output>autopilot/internal/course-error-deg</output>
                <period>
                        <min>-180</min>
                        <max>180</max>
                </period>
                <gain>1.0</gain>
        </filter-->

  <pi-simple-controller>
    <name>LNAV1</name>
    <debug>false</debug>
    <enable>
      <prop>instrumentation/afds/ap-modes/roll-mode</prop>
      <value>LNAV</value>
    </enable>
    <input>
      <!--prop>/autopilot/internal/waypoint-bearing-error-deg</prop-->
      <prop>/autopilot/internal/course-error</prop>
    </input>
    <reference>
      <value>0</value>
    </reference>
    <output>
      <prop>/autopilot/internal/target-roll-deg</prop>
    </output>
    <config>
      <Kp>-2.0</Kp>
      <Ki>0.00</Ki>
        <u_min>
            <prop>instrumentation/afds/settings/bank-min</prop>
        </u_min>
        <u_max>
            <prop>instrumentation/afds/settings/bank-max</prop>
        </u_max>
    </config>
   </pi-simple-controller>

	<!--filter>
                <name>LOC heading error computer/normalizer</name>
                <type>gain</type>
                <debug type="bool">false</debug>
                <gain>1</gain>
                <input>
                        <property>instrumentation/nav[0]/radials/target-auto-hdg-deg</property>
                        <offset>
                                <property>orientation/heading-deg</property>
                                <scale>-1</scale>
                        </offset>
                </input>
                <output>autopilot/internal/nav1-heading-error-deg</output>
                <period>
                        <min>-180</min>
                        <max>180</max>
                </period>
        </filter-->

  <pi-simple-controller>
    <name>LOC1</name>
    <debug>false</debug>
    <enable>
      <prop>instrumentation/afds/ap-modes/roll-mode</prop>
      <value>LOC</value>
    </enable>
    <input>
      <prop>/autopilot/internal/nav1-heading-error-deg</prop>
    </input>
    <reference>
      <value>0.0</value>
    </reference>
    <output>
      <prop>/autopilot/internal/target-roll-deg</prop>
    </output>
    <config>
      <Kp>-0.6</Kp>
      <Ki>0.0</Ki>
        <u_min>
            <prop>instrumentation/afds/settings/bank-min</prop>
        </u_min>
        <u_max>
            <prop>instrumentation/afds/settings/bank-max</prop>
        </u_max>
    </config>
   </pi-simple-controller>

  <pi-simple-controller>
    <name>ROLLOUT</name>
    <debug>false</debug>
    <enable>
      <prop>instrumentation/afds/ap-modes/roll-mode</prop>
      <value>ROLLOUT</value>
    </enable>
    <input>
      <prop>/autopilot/internal/nav1-heading-error-deg</prop>
    </input>
    <reference>
      <value>0.0</value>
    </reference>
    <output>
      <prop>/autopilot/internal/target-roll-deg</prop>
    </output>
    <config>
      <Kp>-5.0</Kp>
      <Ki>0.0</Ki>
      <u_min>-5.0</u_min>
      <u_max>5.0</u_max>
    </config>
   </pi-simple-controller>

  <pid-controller>
    <name>Aileron Control</name>
    <debug>false</debug>
    <enable>
      <prop>autopilot/locks/roll-engaged</prop>
      <value>true</value>
      <honor-passive>true</honor-passive>
    </enable>
    <input>
      <prop>/orientation/roll-deg</prop>
    </input>
    <reference>
      <prop>/autopilot/internal/target-roll-deg</prop>
    </reference>
    <output>
      <prop>/controls/flight/aileron-filter</prop>
      <!--prop>/controls/flight/aileron-trim</prop-->
    </output>
    <config>
      <Kp>0.04</Kp>
      <!--beta>1.0</beta>
      <alpha>0.1</alpha>
      <gamma>0.0</gamma-->
      <Ti>5</Ti>
      <Td>0.0</Td>
      <u_min>
        <value>-0.4</value>
      </u_min>
      <u_max>
        <value>0.4</value>
      </u_max>
    </config>
  </pid-controller>

	<filter>
                <name>Aileron control filter</name>
                <debug>false</debug>
                <type>noise-spike</type>
                <max-rate-of-change>
                        <condition>
                                <greater-than-equals>
                                        <property>/instrumentation/airspeed-indicator/indicated-mach</property>
                                        <value>0.666</value>
                                </greater-than-equals>
                        </condition>
                        <value>0.2</value>
                </max-rate-of-change>
                <max-rate-of-change>
                        <condition>
                                <less-than>
                                        <property>/instrumentation/airspeed-indicator/indicated-mach</property>
                                        <value>0.666</value>
                                </less-than>
                        </condition>
                        <value>0.3</value>
                </max-rate-of-change>
                <max-rate-of-change>
                        <condition>
                                <less-than>
                                        <property>/instrumentation/airspeed-indicator/indicated-mach</property>
                                        <value>0.5</value>
                                </less-than>
                        </condition>
                        <value>0.4</value>
                </max-rate-of-change>
                <max-rate-of-change>
                        <condition>
                                <less-than>
                                        <property>/instrumentation/airspeed-indicator/indicated-mach</property>
                                        <value>0.333</value>
                                </less-than>
                        </condition>
                        <value>0.5</value>
                </max-rate-of-change>
                <feedback-if-disabled>true</feedback-if-disabled>
                <initialize-to>output</initialize-to>
                <enable>
                        <honor-passive>true</honor-passive>
                </enable>
                <input>
                        <property>/controls/flight/aileron-filter</property>
                </input>
                <output>/controls/flight/aileron</output>
        </filter>

    <!-- filter>
        <name>Aileron control filter</name>
        <debug>false</debug>
        <feedback-if-disabled>true</feedback-if-disabled>
        <initialize-to>output</initialize-to>
        <enable>
            <condition>
                <equals>
                    <property>autopilot/locks/passive-mode</property>
                    <value>false</value>
                </equals>
            </condition>
        </enable>
        <input>
            <property>/controls/flight/aileron-trim-filter</property>
        </input>
        <output>/controls/flight/aileron</output>
        <type>noise-spike</type>
        <max-rate-of-change>1</max-rate-of-change>
    </filter -->

 <!-- =============================================================== -->
 <!-- Pitch Axis Modes                                                -->
 <!-- =============================================================== -->

 <pi-simple-controller>
    <name>TO/GA</name>
    <debug>false</debug>
    <enable>
      <prop>instrumentation/afds/ap-modes/pitch-mode</prop>
      <value>TO/GA</value>
    </enable>
    <input>
      <prop>instrumentation/altimeter/indicated-altitude-ft</prop>
    </input>
    <reference>
      <value>10000</value>
    </reference>
    <output>
      <prop>/autopilot/internal/target-climb-rate-fps</prop>
    </output>
    <config>
      <Kp>0.3</Kp>
      <Ki>0.0</Ki>
      <u_min>
        <value>-16.67</value>
      </u_min>
      <u_max>
        <value>33.33</value>
      </u_max>
    </config>
   </pi-simple-controller>

  <pid-controller>
    <name>TO/GA 2</name>
    <debug>false</debug>
    <enable>
      <prop>instrumentation/afds/ap-modes/pitch-mode</prop>
      <value>TO/GA</value>
    </enable>
    <input>
      <prop>/velocities/vertical-speed-fps</prop>
    </input>
    <reference>
      <prop>/autopilot/internal/target-climb-rate-fps</prop>
    </reference>
    <output>
      <prop>/autopilot/internal/target-pitch-deg</prop>
    </output>
    <config>
    <Ts>0.05</Ts> 
      <Kp>0.1</Kp>
      <beta>1.0</beta>
      <alpha>0.1</alpha>
      <gamma>0.0</gamma>
      <Ti>10.0</Ti>
      <Td>0.00001</Td>
        <u_min>
            <prop>instrumentation/afds/settings/pitch-min</prop>
        </u_min>
        <u_max>
            <prop>instrumentation/afds/settings/pitch-max</prop>
        </u_max>
    </config>
  </pid-controller>

  <pi-simple-controller>
    <name>Altitude Stage 1</name>
    <debug>false</debug>
    <enable>
      <condition>
        <or>
          <equals>
            <property>instrumentation/afds/ap-modes/pitch-mode</property>
            <value>ALT</value>
          </equals>
          <equals>
            <property>instrumentation/afds/ap-modes/pitch-mode</property>
	    <value>VNAV ALT</value>
          </equals>
	  <and>
          <equals>
            <property>instrumentation/afds/ap-modes/pitch-mode</property>
            <value>FLCH SPD</value>
          </equals>
	  <equals>
	    <property>/instrumentation/afds/inputs/autothrottle-index</property>
	    <value>5</value>
          </equals>
	  </and>
        </or>
      </condition>
    </enable>
    <input>
      <prop>instrumentation/altimeter/indicated-altitude-ft</prop>
    </input>
    <reference>
      <!--prop>/autopilot/settings/target-altitude-ft</prop-->
      <prop>/autopilot/settings/altitude-setting-ft</prop>
    </reference>
    <output>
      <prop>/autopilot/internal/target-climb-rate-fps</prop>
    </output>
    <config>
      <Kp>0.15</Kp>
      <Ki>0.0</Ki>
      <u_min>
	<prop>instrumentation/afds/settings/flch-min</prop>
      </u_min>
      <u_max>
	<prop>instrumentation/afds/settings/flch-max</prop>
      </u_max>
    </config>
  </pi-simple-controller>

  <pid-controller>
    <name>Altitude Hold (Altimeter based) Stage 2</name>
    <debug>false</debug>
    <enable>
      <condition>
        <or>
          <equals>
            <property>instrumentation/afds/ap-modes/pitch-mode</property>
            <value>ALT</value>
          </equals>
          <equals>
            <property>instrumentation/afds/ap-modes/pitch-mode</property>
	    <value>VNAV ALT</value>
          </equals>
	  <and>
          <equals>
            <property>instrumentation/afds/ap-modes/pitch-mode</property>
            <value>FLCH SPD</value>
          </equals>
	  <equals>
	    <property>/instrumentation/afds/inputs/autothrottle-index</property>
	    <value>5</value>
          </equals>
	  </and>
        </or>
      </condition>
    </enable>
    <input>
      <prop>/velocities/vertical-speed-fps</prop>
    </input>
    <reference>
      <prop>/autopilot/internal/target-climb-rate-fps</prop>
    </reference>
    <output>
      <prop>/autopilot/internal/target-pitch-deg</prop>
    </output>
    <config>
      <Kp>0.3</Kp>
      <beta>1.0</beta>
      <alpha>0.1</alpha>
      <gamma>0.0</gamma>
      <Ti>10.0</Ti>
      <Td>0.0</Td>
        <u_min>
            <prop>instrumentation/afds/settings/pitch-min</prop>
        </u_min>
        <u_max>
            <prop>instrumentation/afds/settings/pitch-max</prop>
        </u_max>
    </config>
  </pid-controller>

  <pid-controller>
    <name>Glideslope Hold</name>
    <debug>false</debug>
    <enable>
      <prop>instrumentation/afds/ap-modes/pitch-mode</prop>
      <value>G/S</value>
    </enable>
    <input>
      <prop>/velocities/vertical-speed-fps</prop>
    </input>
    <reference>
      <prop>/instrumentation/nav[0]/gs-rate-of-climb</prop>
    </reference>
     <output>
      <prop>/autopilot/internal/target-pitch-deg</prop>
    </output>
    <config>
      <Ts>0.05</Ts> 
      <Kp>0.15</Kp>
      <beta>1.0</beta>
      <alpha>0.1</alpha>
      <gamma>0.0</gamma>
      <Ti>10.0</Ti>
      <Td>0.00001</Td>
        <u_min>
            <prop>instrumentation/afds/settings/pitch-min</prop>
        </u_min>
        <u_max>
            <prop>instrumentation/afds/settings/pitch-max</prop>
        </u_max>
    </config>
  </pid-controller>

  <pid-controller>
    <name>VS</name>
    <debug>false</debug>
    <enable>
      <prop>instrumentation/afds/ap-modes/pitch-mode</prop>
      <value>V/S</value>
    </enable>
    <input>
      <prop>/velocities/vertical-speed-fps</prop>
      <!--prop>autopilot/internal/vert-speed-fpm</prop-->
    </input>
    <reference>
      <prop>/autopilot/settings/vertical-speed-fpm</prop>
      <scale>0.01666666</scale>
    </reference>
    <output>
      <prop>/autopilot/internal/target-pitch-deg</prop>
      <!--prop>/autopilot/internal/target-pitch-filter</prop-->
    </output>
    <config>
      <!--Ts>0.05</Ts--> 
      <Kp>0.06</Kp>
      <!--Kp>-0.01</Kp-->
      <beta>1.0</beta>
      <alpha>0.1</alpha>
      <gamma>0.0</gamma>
      <Ti>5.0</Ti>
      <Td>0.00001</Td>
        <u_min>
            <prop>instrumentation/afds/settings/pitch-min</prop>
        </u_min>
        <u_max>
            <prop>instrumentation/afds/settings/pitch-max</prop>
        </u_max>
    </config>
  </pid-controller>

  <!--filter>
    <name>VS Filter</name>
    <debug>false</debug>
    <enable>
      <prop>instrumentation/afds/ap-modes/pitch-mode</prop>
      <value>V/S</value>
    </enable>
    <initialize-to>output</initialize-to>
    <type>gain</type>
    <gain>1.0</gain>
    <input>
      <property>/autopilot/internal/target-pitch-filter</property>
    </input>
    <output>/autopilot/internal/target-pitch-deg</output>
  </filter-->
  
<!--CLB CON-->

  <pid-controller>
    <name>CLB CON</name>
    <debug>false</debug>
    <enable>
      <prop>instrumentation/afds/ap-modes/pitch-mode</prop>
      <value>CLB CON</value>
    </enable>
    <input>
      <prop>/velocities/vertical-speed-fps</prop>
    </input>
    <reference>
      <prop>/autopilot/settings/vertical-speed-mem</prop>
    </reference>
    <output>
      <prop>/autopilot/internal/target-pitch-deg</prop>
    </output>
    <config>
      <Ts>0.05</Ts> 
      <Kp>0.05</Kp>
      <beta>1.0</beta>
      <alpha>0.1</alpha>
      <gamma>0.0</gamma>
      <Ti>10.0</Ti>
      <Td>0.00001</Td>
        <u_min>
            <prop>instrumentation/afds/settings/pitch-min</prop>
        </u_min>
        <u_max>
            <prop>instrumentation/afds/settings/pitch-max</prop>
        </u_max>
    </config>
  </pid-controller>

<!-- CLB CON-->  

  <pid-controller>
    <name>Flare</name>
    <debug>false</debug>
    <enable>
      <prop>instrumentation/afds/ap-modes/pitch-mode</prop>
      <value>FLARE</value>
    </enable>
    <input>
      <prop>/velocities/vertical-speed-fps</prop>
    </input>
    <reference>
      <prop>/autopilot/settings/flare-speed-fps</prop>
    </reference>
    <output>
      <prop>/autopilot/internal/target-pitch-deg</prop>
    </output>
    <config>
      <Ts>0.05</Ts> 
      <Kp>0.15</Kp>
      <beta>1.0</beta>
      <alpha>0.1</alpha>
      <gamma>0.0</gamma>
      <Ti>10.0</Ti>
      <Td>0.00001</Td>
        <u_min>
            <prop>instrumentation/afds/settings/pitch-min</prop>
        </u_min>
        <u_max>
            <prop>instrumentation/afds/settings/pitch-max</prop>
        </u_max>
    </config>
  </pid-controller>
  
  <pid-controller>
    <name>Flight Path Hold</name>
    <debug>false</debug>
    <enable>
      <prop>instrumentation/afds/ap-modes/pitch-mode</prop>
      <value>FPA</value>
    </enable>
    <input>
      <prop>autopilot/internal/fpa</prop>
    </input>
    <reference>
      <prop>/autopilot/settings/flight-path-angle</prop>
    </reference>
    <output>
      <prop>/autopilot/internal/target-pitch-deg</prop>
    </output>
    <config>
      <Ts>0.05</Ts> 
      <Kp>0.15</Kp>
      <beta>1.0</beta>
      <alpha>0.1</alpha>
      <gamma>0.0</gamma>
      <Ti>1.0</Ti>
      <Td>0.0</Td>
        <u_min>
            <prop>instrumentation/afds/settings/pitch-min</prop>
        </u_min>
        <u_max>
            <prop>instrumentation/afds/settings/pitch-max</prop>
        </u_max>
    </config>
  </pid-controller>

	<!-- IAS -->
  <pid-controller>
    <name>Speed with pitch IAS</name>
    <debug type="bool">false</debug>
    <enable>
      <condition>
	<and>
	  <or>
	      <equals>
		<property>instrumentation/afds/ap-modes/pitch-mode</property>
		<value>SPD</value>
	      </equals>
	    <and>
	      <equals>
		<property>instrumentation/afds/ap-modes/pitch-mode</property>
		<value>FLCH SPD</value>
	      </equals>
	      <not><equals>
		<property>/instrumentation/afds/inputs/autothrottle-index</property>
		<value>5</value>
	      </equals></not>
	    </and>
	  </or>
	  <not>
	    <property>/instrumentation/afds/inputs/ias-mach-selected</property>
	  </not>
	</and>
      </condition>
    </enable>
    <input>
      <!--prop>/instrumentation/airspeed-indicator/indicated-speed-kt</prop-->
      <prop>autopilot/internal/lookahead-10-sec-airspeed-kt</prop>
    </input>
    <reference>
      <prop>autopilot/internal/target-ias-kt</prop>
    </reference>
    <output>
      <prop>/autopilot/internal/target-pitch-deg</prop>
    </output>
    <config>
	<Kp>-0.08</Kp>
	<beta>1</beta>
	<alpha>0.1</alpha>
	<gamma>0</gamma>
	<Ti>10</Ti>
	<Td>0.00001</Td>
        <u_min>
            <prop>instrumentation/afds/settings/pitch-min</prop>
        </u_min>
        <u_max>
            <prop>instrumentation/afds/settings/pitch-max</prop>
        </u_max>
    </config>
  </pid-controller>
	<!-- Mach -->
  <predict-simple>
    <name>15-second mach predictor</name>
    <debug type="bool">false</debug>
    <seconds>10</seconds>
    <filter-gain>0</filter-gain>
    <input>
	<prop>instrumentation/airspeed-indicator/indicated-mach</prop>
    </input>
    <output>
	<prop>autopilot/internal/lookahead-15-sec-mach</prop>
    </output>
  </predict-simple>
  <pid-controller>
    <name>Speed with Pitch Mach</name>
    <debug type="bool">false</debug>
    <enable>
      <condition>
	<and>
	  <or>
	      <equals>
		<property>instrumentation/afds/ap-modes/pitch-mode</property>
		<value>SPD</value>
	      </equals>
	    <and>
	      <equals>
		<property>instrumentation/afds/ap-modes/pitch-mode</property>
		<value>FLCH SPD</value>
	      </equals>
	      <not><equals>
		<property>/instrumentation/afds/inputs/autothrottle-index</property>
		<value>5</value>
	      </equals></not>
	    </and>
	  </or>
	  <property>/instrumentation/afds/inputs/ias-mach-selected</property>
	</and>
      </condition>
    </enable>
    <input>
      <!--prop>/instrumentation/airspeed-indicator/indicated-mach</prop-->
      <prop>autopilot/internal/lookahead-15-sec-mach</prop>
    </input>
    <reference>
      <prop>/autopilot/internal/target-mach</prop>
    </reference>
    <output>
      <prop>/autopilot/internal/target-pitch-deg</prop>
    </output>
    <config>
	<Kp>-0.08</Kp>
	<beta>1</beta>
	<alpha>0.1</alpha>
	<gamma>0</gamma>
	<Ti>0.005</Ti>
	<Td>0.00001</Td>
        <u_min>
            <prop>instrumentation/afds/settings/pitch-min</prop>
        </u_min>
        <u_max>
            <prop>instrumentation/afds/settings/pitch-max</prop>
        </u_max>
    </config>
  </pid-controller>

  <filter>
    <name>Vert Initialization filter</name>
    <debug>false</debug>
    <enable>
	<condition>
	   <equals>
		<property>autopilot/locks/passive-mode</property>
		<value>true</value>
	   </equals>
	</condition>
    </enable>
    <type>gain</type>
    <gain>1.0</gain>
    <input>
	<property>/orientation/pitch-deg</property>
    </input>
    <output>/autopilot/internal/target-pitch-deg</output>
  </filter>

  <pid-controller>
    <name>Elevator Control</name>
    <debug>false</debug>
    <enable>
      <prop>autopilot/locks/pitch-engaged</prop>
      <value>true</value>
      <honor-passive>true</honor-passive>
    </enable>
    <input>
      <prop>/orientation/pitch-deg</prop>
    </input>
    <reference>
      <prop>/autopilot/internal/target-pitch-deg</prop>
    </reference>
    <output>
      <prop>/controls/flight/elevator-trim-filter</prop>
      <!--prop>/controls/flight/elevator-trim</prop-->
    </output>
    <config>
      <Kp>-0.010</Kp>
      <beta>1.0</beta>
      <alpha>0.1</alpha>
      <gamma>0.0</gamma>
      <Ti>1.0</Ti>
      <Td>0.00001</Td>
      <u_min>
        <value>-0.8</value>
      </u_min>
      <u_max>
        <value>0.8</value>
      </u_max>
    </config>
  </pid-controller>

    <filter>
        <name>Elevator control filter</name>
        <debug>false</debug>
        <feedback-if-disabled>true</feedback-if-disabled>
        <initialize-to>output</initialize-to>
        <enable>
            <condition>
                <equals>
                    <property>autopilot/locks/passive-mode</property>
                    <value>false</value>
                    <!--property>autopilot/locks/pitch-engaged</property>
                    <value>true</value-->
                </equals>
            </condition>
        </enable>
        <input>
            <property>/controls/flight/elevator-trim-filter</property>
        </input>
        <output>/controls/flight/elevator-trim</output>
        <type>noise-spike</type>
        <max-rate-of-change>0.2</max-rate-of-change>
    </filter>


</PropertyList>
